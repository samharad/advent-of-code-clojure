(ns aoc.2022.day.04
  (:require
    [clojure.string :as str]
    [clojure.string :as s]))

(def input "60-60,45-60\n36-57,7-36\n2-32,1-55\n1-30,6-75\n12-13,13-90\n48-98,48-98\n29-29,29-51\n5-8,7-92\n39-91,38-90\n3-41,16-86\n64-64,65-95\n4-4,5-96\n8-43,9-22\n82-88,20-46\n19-20,9-20\n73-74,10-74\n23-29,22-23\n21-82,22-83\n36-36,36-84\n34-35,35-74\n3-98,8-98\n42-51,50-50\n44-93,45-94\n65-88,78-90\n37-76,43-76\n46-63,8-63\n2-91,58-92\n8-8,8-74\n50-50,46-50\n11-75,10-76\n16-95,17-94\n81-94,80-89\n7-76,9-75\n99-99,1-99\n3-52,4-53\n48-81,40-80\n13-65,14-14\n96-99,2-95\n7-98,1-98\n24-93,23-42\n28-29,29-64\n34-86,33-87\n71-84,70-71\n24-29,28-82\n22-87,15-21\n62-70,45-69\n45-48,44-52\n34-63,35-62\n14-14,15-83\n1-40,10-39\n45-97,46-98\n36-58,18-57\n24-92,23-93\n15-65,5-15\n80-81,80-81\n8-97,97-97\n18-27,17-28\n35-35,36-53\n46-51,47-56\n43-64,42-63\n31-88,89-93\n44-96,97-97\n3-9,8-56\n48-58,16-47\n13-89,12-90\n3-98,4-99\n20-32,20-90\n20-96,97-97\n27-93,28-93\n23-49,22-48\n44-75,44-44\n15-15,15-87\n84-90,61-82\n2-97,97-99\n25-82,24-25\n29-29,15-29\n23-23,24-47\n34-98,4-97\n37-72,36-73\n61-66,55-65\n66-70,70-70\n81-87,82-93\n97-97,17-97\n3-47,4-84\n83-92,46-87\n8-51,9-55\n5-86,14-45\n46-74,75-94\n60-61,61-86\n57-66,60-84\n75-78,52-74\n14-89,93-93\n1-93,1-1\n24-30,23-31\n80-85,79-84\n71-71,30-70\n46-90,70-90\n11-11,11-79\n56-84,55-74\n11-86,12-87\n72-86,49-59\n37-87,77-88\n27-74,27-66\n31-63,30-31\n59-89,58-90\n4-48,5-5\n56-63,62-63\n15-87,1-31\n11-57,10-63\n43-55,24-42\n27-79,28-78\n32-79,3-80\n22-56,21-55\n4-91,3-94\n41-49,49-58\n18-77,12-13\n6-74,7-75\n38-97,96-97\n24-89,23-88\n25-91,91-91\n65-66,66-78\n62-90,63-85\n60-74,73-73\n52-59,53-58\n15-77,16-78\n23-48,47-48\n18-53,37-47\n8-10,5-9\n31-63,19-27\n3-39,4-4\n44-77,45-77\n80-84,2-79\n1-81,16-69\n7-7,7-7\n25-81,6-82\n80-90,23-90\n3-83,5-81\n14-74,13-73\n7-64,8-63\n54-73,55-74\n6-76,5-5\n63-67,60-66\n12-62,12-13\n9-82,16-82\n3-94,4-95\n34-63,33-35\n14-15,15-99\n95-97,3-58\n13-76,20-77\n7-87,6-88\n74-97,40-83\n14-93,94-94\n4-86,1-89\n2-91,1-90\n69-96,3-96\n22-96,22-97\n80-91,33-79\n33-83,32-33\n96-96,26-95\n5-96,37-93\n22-83,22-98\n22-93,21-94\n14-88,87-89\n21-74,22-73\n53-87,1-54\n22-96,98-98\n54-75,9-53\n1-97,8-97\n27-57,26-56\n4-42,43-43\n95-95,4-95\n84-84,65-84\n13-22,12-23\n12-57,11-46\n13-13,12-16\n9-74,10-74\n4-96,5-98\n5-94,4-77\n81-98,7-81\n14-95,13-75\n38-73,39-74\n16-49,34-73\n8-89,9-88\n1-73,74-90\n11-97,5-93\n17-80,10-80\n51-57,50-83\n3-22,20-27\n5-91,6-92\n45-80,23-34\n56-57,5-57\n2-61,1-3\n35-64,34-63\n16-77,77-86\n85-86,1-85\n50-89,49-49\n32-55,55-55\n39-79,80-96\n25-66,95-98\n45-57,23-37\n52-97,34-83\n7-8,8-28\n1-85,1-72\n8-86,9-87\n80-91,2-80\n40-78,41-74\n16-82,16-17\n55-78,78-79\n26-95,19-27\n50-53,49-51\n16-63,63-89\n6-73,5-74\n3-43,5-97\n17-97,35-98\n17-18,38-45\n67-85,15-66\n9-20,10-90\n2-33,8-98\n28-91,24-90\n65-78,64-66\n24-25,19-24\n21-70,9-70\n25-68,9-69\n39-75,38-92\n77-78,57-78\n63-89,62-63\n52-52,53-78\n9-94,10-95\n17-62,52-61\n30-32,31-97\n8-67,56-65\n58-77,4-57\n85-85,13-86\n12-98,11-99\n5-95,4-96\n10-84,9-85\n1-8,7-41\n8-66,65-67\n1-98,98-99\n9-32,10-10\n5-84,3-83\n32-38,16-41\n17-34,33-69\n3-98,2-96\n13-80,90-90\n21-79,20-20\n2-17,1-96\n29-99,28-29\n64-72,73-73\n3-92,2-95\n3-7,6-61\n33-89,6-88\n18-19,10-19\n89-91,13-90\n4-95,3-3\n98-98,9-99\n43-62,29-99\n39-47,38-46\n10-88,2-11\n6-78,2-22\n9-28,27-74\n18-93,41-94\n91-95,92-95\n38-38,17-38\n15-56,14-15\n68-69,65-67\n30-30,30-38\n54-58,49-57\n64-65,65-66\n8-89,7-8\n28-93,94-94\n31-71,70-71\n3-99,2-98\n49-87,50-88\n60-62,62-76\n57-83,82-82\n70-70,31-70\n7-90,19-83\n36-50,35-46\n7-68,6-96\n58-58,41-57\n13-41,40-59\n28-28,30-73\n25-27,8-26\n1-85,85-85\n2-12,11-83\n62-76,61-75\n21-78,20-77\n20-95,19-96\n25-25,25-38\n52-97,97-98\n24-86,87-98\n25-93,93-95\n23-96,22-98\n26-50,56-60\n26-82,26-86\n73-80,74-74\n66-92,92-92\n34-51,35-52\n36-48,35-47\n10-99,9-11\n35-35,36-38\n5-89,10-90\n73-74,15-74\n16-86,98-99\n63-83,84-98\n8-23,2-22\n5-38,3-3\n6-93,2-3\n32-93,8-92\n60-61,32-61\n6-99,3-7\n11-90,10-89\n37-78,37-51\n48-84,48-53\n75-89,53-92\n6-27,27-27\n24-31,63-83\n39-52,38-40\n20-99,14-95\n8-92,9-93\n23-69,22-68\n22-56,23-50\n4-62,3-84\n1-98,2-98\n3-77,8-99\n20-90,90-90\n37-44,38-38\n44-73,72-73\n12-65,13-64\n65-92,93-98\n5-83,15-84\n3-83,2-2\n71-98,31-97\n9-82,82-82\n29-81,28-71\n59-92,92-93\n18-54,12-55\n14-65,14-64\n56-56,56-56\n16-28,16-24\n38-85,85-86\n46-64,47-66\n20-93,21-21\n2-92,2-97\n2-55,21-55\n21-42,20-21\n5-5,4-97\n14-83,15-84\n6-95,5-96\n2-83,82-84\n47-47,3-47\n54-85,11-53\n20-20,20-78\n33-93,32-92\n19-68,19-68\n25-90,24-25\n29-90,68-91\n7-82,83-83\n6-22,9-22\n6-97,10-98\n23-97,98-99\n80-81,30-80\n25-75,24-25\n27-27,26-79\n78-80,39-79\n42-84,42-42\n93-98,12-90\n35-36,36-78\n56-97,75-86\n7-30,27-31\n64-66,3-65\n2-50,2-80\n58-92,59-93\n20-33,19-32\n54-55,4-55\n3-25,4-23\n50-78,51-51\n29-62,28-29\n10-23,22-24\n59-99,2-98\n55-97,19-95\n4-61,60-81\n25-43,44-91\n4-86,2-93\n12-96,75-97\n68-92,69-91\n23-46,23-23\n23-43,22-42\n40-40,40-74\n25-37,38-38\n23-89,90-95\n3-92,3-59\n52-83,91-97\n7-35,34-36\n62-90,89-91\n58-75,57-74\n98-99,60-97\n18-72,7-11\n64-64,33-64\n7-79,79-79\n45-75,75-90\n76-80,75-81\n8-94,10-87\n10-10,9-17\n13-98,97-97\n13-85,85-93\n22-68,21-23\n33-33,33-37\n3-51,21-52\n71-81,17-70\n10-68,49-70\n72-93,72-74\n84-97,60-85\n20-61,20-60\n80-99,80-83\n6-89,7-88\n86-86,27-88\n66-83,61-67\n80-82,11-81\n89-95,49-86\n1-90,2-18\n4-44,5-68\n2-59,1-60\n6-64,6-6\n94-97,26-94\n85-86,86-90\n16-64,47-65\n19-97,3-99\n13-86,12-85\n6-97,1-1\n7-42,43-45\n57-57,28-57\n58-72,72-73\n12-12,11-80\n14-75,13-75\n13-89,3-14\n7-96,6-7\n57-96,59-99\n20-21,21-50\n23-23,24-52\n35-96,34-35\n2-33,7-93\n3-60,7-60\n19-56,20-57\n16-66,56-85\n15-81,14-80\n76-98,57-97\n70-92,50-69\n5-9,7-16\n52-67,66-66\n94-97,43-88\n6-36,35-36\n6-6,5-96\n15-37,16-16\n37-77,37-37\n25-85,16-84\n77-96,24-77\n66-83,31-66\n36-89,36-36\n25-68,69-99\n12-51,52-52\n28-99,10-29\n7-16,2-17\n9-82,82-90\n42-98,41-83\n50-72,48-72\n23-97,22-98\n32-44,43-44\n3-91,1-95\n5-46,2-3\n31-90,4-84\n22-45,21-95\n20-68,8-21\n90-90,69-90\n6-74,4-17\n56-94,57-95\n11-61,61-62\n56-68,57-69\n6-75,5-6\n51-64,26-49\n3-79,3-78\n23-54,22-22\n32-95,32-94\n85-87,49-86\n2-64,3-66\n3-10,11-58\n17-20,20-20\n38-68,39-39\n27-77,28-76\n22-82,23-91\n17-74,18-75\n32-42,25-75\n25-25,25-56\n7-18,8-19\n78-95,78-96\n37-45,31-46\n11-99,7-8\n35-98,97-97\n21-54,22-53\n46-48,2-47\n2-94,1-94\n3-99,2-98\n18-96,95-97\n3-99,3-99\n19-77,76-78\n32-48,31-47\n30-43,27-42\n20-36,21-23\n68-81,61-73\n39-71,40-72\n91-99,31-71\n8-85,9-86\n70-70,21-69\n95-99,18-94\n19-67,67-67\n49-49,64-68\n25-54,55-55\n21-66,20-65\n2-90,7-89\n82-82,22-81\n22-53,22-36\n90-97,61-90\n36-87,35-88\n88-95,12-87\n96-98,7-97\n5-84,2-6\n68-68,67-87\n29-58,59-59\n74-75,3-75\n25-94,15-26\n44-45,45-84\n40-56,57-82\n30-97,26-30\n6-87,87-91\n7-75,7-46\n4-4,5-12\n18-23,18-18\n1-2,2-21\n14-85,15-86\n12-91,43-79\n21-66,65-73\n51-85,95-98\n55-79,42-84\n25-90,26-26\n28-91,27-29\n4-96,10-95\n35-88,26-26\n32-67,31-67\n21-21,21-80\n51-65,29-52\n61-73,62-72\n5-36,5-32\n3-97,97-98\n43-79,42-80\n20-39,31-32\n36-51,19-51\n20-20,21-66\n25-77,6-24\n34-36,35-47\n15-98,5-15\n3-32,2-48\n28-29,29-90\n4-99,2-5\n6-86,7-85\n15-97,15-96\n13-79,2-79\n3-83,2-97\n1-47,11-82\n50-56,24-49\n79-80,48-79\n42-57,43-58\n3-88,88-89\n13-44,14-43\n7-24,8-25\n14-86,13-13\n26-85,27-97\n13-63,15-64\n30-93,31-31\n95-95,61-94\n48-86,51-89\n86-86,8-86\n36-78,37-37\n16-26,15-27\n79-94,7-79\n12-12,11-63\n72-82,24-82\n84-89,48-83\n54-63,55-55\n50-50,50-86\n67-98,4-40\n87-99,99-99\n24-52,23-91\n40-41,41-58\n24-92,5-93\n25-61,26-62\n75-90,59-89\n3-50,49-77\n33-45,32-33\n64-67,64-64\n22-77,23-92\n4-4,4-99\n36-60,35-87\n4-89,2-3\n23-55,24-54\n7-98,4-97\n4-49,1-1\n62-80,61-81\n20-75,20-41\n39-41,40-57\n16-34,34-47\n89-89,7-90\n7-13,7-11\n98-98,1-98\n14-91,14-14\n34-57,58-58\n5-95,94-96\n5-42,6-6\n17-18,18-62\n79-79,64-79\n28-73,64-99\n4-98,99-99\n4-77,3-78\n4-87,19-86\n79-79,19-78\n32-32,32-97\n77-99,11-57\n7-92,6-93\n1-83,11-78\n37-97,36-37\n17-67,17-74\n1-90,2-39\n10-86,9-9\n1-95,93-96\n4-97,3-98\n42-70,43-70\n39-90,4-90\n22-43,6-84\n14-41,13-93\n67-79,49-66\n10-48,45-99\n9-98,98-99\n4-94,7-95\n6-12,14-61\n44-93,23-94\n17-17,18-18\n24-89,88-88\n17-69,18-49\n19-89,18-30\n31-74,75-99\n2-44,21-43\n1-3,2-98\n4-99,5-98\n74-74,42-73\n95-96,3-96\n39-61,40-62\n9-11,19-94\n1-92,4-91\n20-82,18-20\n1-8,4-51\n42-45,13-50\n7-38,67-95\n14-85,84-84\n3-5,6-93\n10-59,11-53\n65-83,2-66\n14-97,97-97\n2-99,3-97\n51-95,44-88\n30-47,29-48\n7-36,15-76\n8-8,9-43\n2-93,1-84\n29-29,30-36\n13-30,44-71\n8-98,7-94\n5-67,6-97\n99-99,1-99\n80-80,23-80\n82-82,6-81\n91-92,20-91\n25-28,37-43\n7-94,8-96\n25-44,24-26\n42-88,24-69\n5-82,9-20\n63-98,63-82\n86-87,2-86\n4-58,4-75\n98-98,2-97\n43-66,17-43\n33-61,61-61\n14-15,15-98\n18-96,5-17\n17-39,11-39\n95-95,11-45\n7-88,6-98\n27-27,24-27\n5-93,6-97\n12-33,32-42\n14-83,83-86\n5-7,4-8\n16-86,15-85\n29-99,99-99\n64-64,19-63\n1-99,1-37\n90-90,42-89\n74-78,44-67\n70-85,54-84\n13-99,9-98\n16-18,20-54\n5-65,1-6\n72-72,9-71\n4-4,7-97\n9-96,2-10\n5-6,6-39\n52-65,51-52\n13-77,16-76\n71-88,72-89\n5-6,3-6\n35-46,45-47\n45-87,38-88\n6-76,40-77\n67-72,66-94\n11-62,8-8\n4-9,3-10\n24-33,56-92\n5-82,83-83\n59-59,59-79\n23-87,22-23\n90-93,54-87\n9-35,35-35\n6-96,96-96\n2-9,8-84\n25-34,28-35\n52-93,53-97\n25-90,90-93\n86-94,86-93\n18-48,17-47\n4-45,4-98\n3-69,4-4\n3-93,3-34\n4-59,3-37\n20-87,19-86\n26-76,77-84\n19-97,9-20\n11-99,2-11\n4-25,26-52\n7-99,4-8\n4-88,1-94\n31-41,40-63\n10-73,72-74\n91-95,23-95\n27-85,85-86\n48-69,38-47\n69-69,68-82\n6-91,91-91\n5-59,59-59\n18-61,5-19\n62-76,61-77\n87-88,85-87\n76-76,8-76\n11-83,10-10\n35-66,12-48\n63-96,64-92\n41-94,40-42\n98-98,19-98\n45-91,46-90\n7-25,8-26\n38-84,37-85\n3-74,2-93\n14-25,25-38\n27-93,45-98\n9-52,8-53\n61-77,34-77\n6-96,33-86\n1-72,2-71\n46-93,35-39\n10-55,22-55\n55-78,54-77\n25-26,26-27\n7-17,18-95\n1-83,34-82\n73-73,60-73\n68-83,82-84\n8-9,9-84\n10-82,3-82\n13-94,7-14\n3-7,8-98\n25-52,24-24\n27-41,26-42\n27-69,25-25\n35-86,87-89\n9-29,1-28\n17-32,17-95\n8-95,9-95\n29-58,52-65\n10-10,9-61\n27-28,13-30\n89-89,18-88\n91-91,6-91\n49-60,59-61\n12-95,11-11\n6-97,97-97\n2-99,2-2\n1-47,3-99\n85-96,4-84\n73-74,74-89\n29-97,98-99\n66-79,61-78\n6-24,3-36\n69-69,8-69\n20-92,19-95\n18-31,28-91\n23-60,24-59\n50-51,3-51\n79-89,39-78\n15-87,4-87\n1-36,37-57\n8-94,7-8\n58-61,34-42\n18-97,14-42\n30-62,63-63\n83-98,82-96\n19-67,14-18\n35-39,40-81\n2-97,1-96\n11-93,14-83\n3-86,1-20\n8-48,1-8\n84-96,29-83\n55-91,54-91\n36-64,35-66\n22-60,22-55\n14-91,13-86\n3-58,57-58\n6-10,17-66\n18-61,62-62\n11-98,61-71\n49-74,34-73\n32-85,33-84\n70-78,61-72\n66-66,66-69\n10-97,62-91\n17-24,18-23\n92-94,3-93\n4-32,11-33\n45-49,49-71\n1-48,4-49\n21-85,11-84\n2-2,1-96\n55-81,81-81\n13-64,25-64\n61-78,74-79\n9-97,10-81\n40-45,41-44\n74-74,37-74\n86-95,86-95\n40-57,40-99\n34-74,33-75\n96-96,29-97\n8-11,10-34\n5-64,63-63\n1-95,2-94\n13-28,13-56\n10-10,9-13\n1-90,91-91\n15-98,54-98\n10-10,9-78\n14-37,18-55\n25-76,76-77\n98-99,39-96\n39-43,38-42\n97-97,37-96\n33-50,15-49\n15-15,16-19\n24-59,1-73\n43-92,21-99\n31-70,69-86\n40-88,9-87\n10-72,11-73\n7-55,12-71\n9-69,8-9\n34-41,35-44\n15-16,2-97\n32-45,4-33\n7-66,6-26\n57-66,65-97\n17-29,16-28\n7-32,19-91\n6-6,6-65\n30-49,30-40\n2-4,4-82\n18-79,80-80\n3-31,1-1\n63-94,63-95\n2-54,42-54\n57-73,57-57\n16-92,15-93\n29-49,30-35\n18-35,25-35\n27-87,1-88\n9-59,60-60\n31-82,30-88\n9-61,10-37\n65-65,42-64\n45-45,1-44\n15-34,9-16\n9-40,34-99\n18-94,94-95\n6-36,35-97\n5-74,4-99\n66-66,20-66\n47-69,48-68\n16-99,8-98\n22-36,35-37\n13-71,43-71\n98-98,1-99\n17-17,16-79\n16-16,15-89\n82-90,81-91\n11-11,10-94\n47-47,47-90\n7-9,8-60\n11-98,12-96\n37-74,74-75\n41-88,41-41\n97-98,53-96\n4-64,1-2\n43-92,44-94\n9-86,10-86\n14-28,13-37\n1-63,3-63\n81-81,80-88\n37-55,38-54\n25-80,26-79\n16-92,15-17\n14-14,13-48\n19-90,18-19\n68-87,8-67\n6-89,3-89\n9-97,10-98\n53-71,52-52\n74-95,74-74\n33-82,81-83\n40-47,39-40\n50-50,10-50\n15-17,16-76\n12-77,77-78\n58-65,64-82\n6-96,5-95\n7-91,8-90\n14-15,21-71\n36-99,99-99\n5-92,4-50\n39-41,40-59\n48-97,47-98\n31-42,30-41\n66-79,9-66\n30-30,30-82\n15-96,16-16\n67-98,68-99\n25-27,26-96\n19-67,20-66\n28-54,55-57\n66-82,66-81\n10-42,1-62\n4-7,5-6\n20-21,10-21\n54-98,97-98\n7-97,96-97\n2-3,2-52\n58-74,19-58\n11-95,21-87\n16-50,2-44\n2-87,1-94\n52-58,5-51\n7-13,6-23\n37-38,34-38\n2-94,1-95\n62-62,63-81\n34-97,34-69\n24-90,23-90\n49-69,49-49\n15-16,16-49\n10-89,9-90\n2-91,7-90\n20-94,17-93\n4-90,4-4\n48-65,66-66\n57-76,55-75\n19-95,96-97\n63-78,5-88\n43-43,43-86\n57-61,1-60\n1-99,51-75\n1-24,1-23\n65-83,64-83\n78-78,27-77\n9-76,3-77\n")

(defn parse-range [s]
  (mapv parse-long (s/split s #"-")))

(defn line->range-pair [line]
  (mapv parse-range (s/split line #",")))

(defn parse-range-pairs [input]
  (map line->range-pair (str/split-lines input)))

(def range-pairs (parse-range-pairs input))

(defn fully-contains? [[as ae] [bs be]]
  (and (<= as bs ae)
       (<= as be ae)))

(defn containment? [a b]
  (or (fully-contains? a b) (fully-contains? b a)))

(->> range-pairs
     (filter #(apply containment? %))
     count)

(defn overlap? [[as ae] [bs be]]
  (or (<= bs as be)
      (<= as bs ae)))

(->> range-pairs
     (filter #(apply overlap? %))
     count)